<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Telegram Document Manager</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <h1>Управление документами</h1>

  <div class="tabs">
    <button class="tab-button active" onclick="openTab('uploadTab')">Загрузка документов</button>
    <button class="tab-button" onclick="openTab('myDocsTab')">Мои документы</button>
    <button class="tab-button" onclick="openTab('receivedDocsTab')">Полученные документы</button>
    <button class="tab-button" onclick="openTab('settingsTab')">Настройки</button>
  </div>

  <div id="uploadTab" class="tab-content">
    <h2>Загрузка документов</h2>
    <label for="fileInput">Загрузите документ:</label>
    <input type="file" id="fileInput" accept=".pdf,.docx,.doc,.xlsx">
    <button onclick="uploadDocument()">Загрузить</button>
  </div>

  <div id="myDocsTab" class="tab-content" style="display: none;">
    <h2>Мои документы</h2>
    <select id="myDocumentsSelect">
      <option value="" disabled selected>Выберите документ</option>
    </select>
    <br><br>
    <label for="recipientId">ID получателя:</label>
    <input type="text" id="recipientId" placeholder="Введите ID получателя">
    <button onclick="sendDocument()">Отправить</button>
  </div>

  <div id="receivedDocsTab" class="tab-content" style="display: none;">
    <h2>Полученные документы</h2>
    <ul id="receivedDocuments"></ul>
  </div>

  <div id="settingsTab" class="tab-content" style="display: none;">
    <h2>Настройки</h2>
    <p>Здесь могут быть настройки приложения.</p>
  </div>

  <script>
    const tg = Telegram.WebApp;

    // Переход между вкладками
    function openTab(tabId) {
      document.querySelectorAll('.tab-content').forEach(tab => tab.style.display = 'none');
      document.querySelectorAll('.tab-button').forEach(button => button.classList.remove('active'));
      document.getElementById(tabId).style.display = 'block';
      event.currentTarget.classList.add('active');
    }

    // Загрузка документа
    function uploadDocument() {
      const fileInput = document.getElementById('fileInput');
      const file = fileInput.files[0];
      if (!file) {
        alert("Пожалуйста, выберите файл для загрузки.");
        return;
      }

      const myDocumentsSelect = document.getElementById('myDocumentsSelect');
      const option = document.createElement('option');
      option.textContent = file.name;
      option.value = file.name;
      myDocumentsSelect.appendChild(option);

      alert(`Документ "${file.name}" успешно загружен.`);
      fileInput.value = ''; // Очистка файла
    }

    // Отправка документа
    function sendDocument() {
      const recipientId = document.getElementById('recipientId').value;
      const myDocumentsSelect = document.getElementById('myDocumentsSelect');
      const selectedDoc = myDocumentsSelect.value;

      if (!recipientId || !selectedDoc) {
        alert("Пожалуйста, выберите документ и введите ID получателя.");
        return;
      }

      tg.sendData(JSON.stringify({
        action: "sendDocument",
        fileName: selectedDoc,
        recipientId: recipientId
      }));

      alert(`Документ "${selectedDoc}" отправлен пользователю с ID ${recipientId}.`);
    }

    // Заглушка для получения документов
    function loadReceivedDocuments() {
      const receivedDocsList = document.getElementById('receivedDocuments');
      receivedDocsList.innerHTML = ''; // Очистить список перед добавлением

      const mockDocuments = [];

      mockDocuments.forEach(doc => {
        const listItem = document.createElement('li');
        listItem.textContent = doc;
        receivedDocsList.appendChild(listItem);
      });
    }

    // При загрузке страницы заполняем вкладку "Полученные документы"
    loadReceivedDocuments();
  </script>
</body>
</html>
